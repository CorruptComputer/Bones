@inject IBonesApiClient ApiClient

<MudDialog>
    <TitleContent>
        @if (LoginFlow)
        {
            <MudText Typo="Typo.h5">Login</MudText>
        }
        else
        {
            <MudText Typo="Typo.h5">Register</MudText>
        }
    </TitleContent>
    <DialogContent>
        <MudContainer MaxWidth="MaxWidth.Medium">
            <MudPaper MaxWidth="100%" Width="500px" Height="250px" Elevation="0">
                @if (LoginFlow)
                {
                    <MudTextField FullWidth="true" T="string" Label="Email Address" @bind-value="@EmailAddress" InputType="InputType.Email"/>
                    <MudTextField FullWidth="true" T="string" Label="Password" Value="@Password" ValueChanged="PasswordChangedEvent" InputType="InputType.Password"/>
                }
                else
                {
                    @if (!RegistrationSuccess)
                    {
                        <MudTextField FullWidth="true" T="string" Label="Email Address" @bind-value="@EmailAddress" InputType="InputType.Email"/>
                        <MudTextField FullWidth="true" T="string" Label="Password" Value="@Password" ValueChanged="PasswordChangedEvent" InputType="InputType.Password"/>
                        <MudTextField FullWidth="true" T="string" Label="Password (again)" Value="@PasswordAgain" ValueChanged="PasswordAgainChangedEvent" InputType="InputType.Password"/>

                        <MudAlert Style="" Severity="Severity.Warning" hidden="@PasswordComplexEnough">Password must contain lowercase, uppercase, number, special, and be at least 8 characters long.</MudAlert>
                        <MudAlert Severity="Severity.Error" hidden="@PasswordsMatch">Passwords do not match!</MudAlert>
                        <MudAlert Severity="Severity.Error" hidden="@(string.IsNullOrWhiteSpace(RegistrationError))" @bind-value="@RegistrationError"/>
                    }
                    else
                    {
                        <MudAlert Severity="Severity.Success">Account created successfully, please check your email for a confirmation link.</MudAlert>
                    }
                }
            </MudPaper>
        </MudContainer>
        
    </DialogContent>
    <DialogActions>
        @if (LoginFlow)
        {
            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@DoLoginAsync">Login</MudButton>
            <MudSpacer />
            <MudButton Variant="Variant.Text" Color="Color.Secondary" OnClick="@ToggleLoginFlow">Don't have an account?</MudButton>
        }
        else
        {
            @if (!RegistrationSuccess)
            {
                <MudButton Variant="Variant.Text" Color="Color.Secondary" OnClick="@ToggleLoginFlow">Have an account?</MudButton>
                <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@DoRegistrationAsync">Register</MudButton>
            }
        }
    </DialogActions>
</MudDialog>